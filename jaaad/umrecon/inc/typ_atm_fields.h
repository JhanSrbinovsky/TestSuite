! *****************************COPYRIGHT*******************************
! (C) Crown copyright Met Office. All rights reserved.
! For further details please refer to the file COPYRIGHT.txt
! which you should have received as part of this distribution.
! *****************************COPYRIGHT*******************************
!

! Start typ_atm_fields.h

! Description:
!  Contains set of atmospheric fields to be used as arguments to subroutines
!  without referring explicitly to D1 or "jpointers".
!  This file should replace "typptra.h", and requires that "ctracera.h" is
!  also included.  By 7.1 these should all be their natural shape instead
!  of all being 1D arrays.
!
! Current Code Owner: A. Treshansky
!

      ! 1.1: Data variables stored in primary space.
      real :: U(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: V(1-offx:row_length+offx,1-offy:n_rows+offy,model_levels)
      real :: W(1-offx:row_length+offx,1-offy:rows+offy,0:model_levels)
      real :: RHO(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: THETA(1-offx:row_length+offx,1-offy:rows+offy,model_levels)

      real :: Q(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: QCL(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: QCF(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: QCF2(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: QRAIN(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: QGRAUP(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)

! EXNER_RHO_LEVELS is still 1D; change for 7.1
      ! Exner pressure on rho levels
      real :: EXNER_RHO_LEVELS(((2*offx)+row_length)*((2*offy)+rows)*(model_levels+1))   

      real :: U_ADV(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: V_ADV(1-offx:row_length+offx,1-offy:n_rows+offy,model_levels)
      real :: W_ADV(1-offx:row_length+offx,1-offy:rows+offy,0:model_levels)

! P is still 1D; change for 7.1
      ! 1.2: Data variables stored in secondary space.
      real :: P(((2*offx)+row_length)*((2*offy)+rows)*(model_levels+1))

      ! Pressure on theta levels
      real :: P_THETA_LEVELS(1-offx:row_length+offx,1-offy:rows+offy,model_levels)

      ! Exner pressure on theta levels
      real :: EXNER_THETA_LEVELS(1-offx:row_length+offx,1-offy:rows+offy,model_levels)

      ! 1.3: Cloud Fields
      real :: CCW_RAD(row_length,rows,wet_levels)
      ! CCA's size is dependant on L_3D_CCA
      ! N_CCA_LEV will be set to the correct value (either wet_levels or 1)
      real :: CCA(row_length,rows,n_cca_lev)
      real :: CF_AREA(row_length,rows,wet_levels)
      real :: CF_BULK(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: CF_LIQUID(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)
      real :: CF_FROZEN(1-halo_i:row_length+halo_i,1-halo_j:rows+halo_j,wet_levels)

      ! 1.4: Soil Ancillary fields
      real :: DEEP_SOIL_TEMP(land_field,sm_levels)
      real :: SMCL(land_field,sm_levels)
      real :: STHU(land_field,sm_levels)
      real :: STHF(land_field,sm_levels)

      ! 1.5: Radiation Increments
      real :: SW_INCS(row_length,rows,0:model_levels+1)  ! SW radiation increments
      real :: LW_INCS(row_length,rows,0:model_levels)    ! LW radiation increments
! PAR radiation increment
      real :: DIRPAR(row_length,rows)

! OZONE fields are still 1D; change for 7.1
      ! 1.6: Ozone
      real :: O3(row_length*rows*ozone_levels)
!  tropopause-based ozone
      real :: TPPSOZONE(row_length*rows*ozone_levels)
!  Cariolle ozone tracer variables
      real :: OZONE_TRACER(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: O3_PROD_LOSS(1,rows,model_levels)
      real :: O3_P_L_VMR(1,rows,model_levels)
      real :: O3_VMR(1,rows,model_levels)
      real :: O3_P_L_TEMP(1,rows,model_levels)
      real :: O3_TEMP(1,rows,model_levels)
      real :: O3_P_L_COLO3(1,rows,model_levels)
      real :: O3_COLO3(1,rows,model_levels)
      
! TRACERS are still 1D; change for 7.1
      ! 1.7: Tracer and aerosol fields
      ! TRACERS are dealt w/ differently
      ! these are the maximum sizes:
      real :: TRACER(tr_levels*theta_off_size*(a_tracer_last-a_tracer_first))
      real :: TRACER_UKCA(tr_levels*theta_off_size*(a_ukca_last-a_ukca_first))
      real :: TRACER_LBC(LENRIMA(fld_type_p,halo_type_extended,1)*tr_levels*tr_vars)
      real :: TRACER_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1)*tr_levels*tr_vars)

      real :: MURK_SOURCE(row_length,rows,model_levels)
      real :: MURK(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DUST_DIV1(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DUST_DIV2(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DUST_DIV3(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DUST_DIV4(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DUST_DIV5(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DUST_DIV6(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SO2(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: DMS(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SO4_AITKEN(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SO4_ACCU(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SO4_DISS(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: H2O2(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: NH3(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SOOT_NEW(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SOOT_AGD(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SOOT_CLD(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: BMASS_NEW(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: BMASS_AGD(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: BMASS_CLD(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: OCFF_NEW(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: OCFF_AGD(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: OCFF_CLD(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: SO2_NATEM(row_length,rows,model_levels)
      real :: OH(row_length,rows,model_levels)
      real :: HO2(row_length,rows,model_levels)
      real :: H2O2_LIMIT(row_length,rows,model_levels)
      real :: O3_CHEM(row_length,rows,model_levels)
      real :: CO2(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: CH4_STOCH(row_length,rows,model_levels)
      real :: O3_STOCH(row_length,rows,model_levels)

! USER_MULT<N> are still 1D; change for 7.1
! 1.8: Multi-level user ancillary fields
      real :: USER_MULT1(row_length*rows*model_levels)
      real :: USER_MULT2(row_length*rows*model_levels)
      real :: USER_MULT3(row_length*rows*model_levels)
      real :: USER_MULT4(row_length*rows*model_levels)
      real :: USER_MULT5(row_length*rows*model_levels)
      real :: USER_MULT6(row_length*rows*model_levels)
      real :: USER_MULT7(row_length*rows*model_levels)
      real :: USER_MULT8(row_length*rows*model_levels)
      real :: USER_MULT9(row_length*rows*model_levels)
      real :: USER_MULT10(row_length*rows*model_levels)
      real :: USER_MULT11(row_length*rows*model_levels)
      real :: USER_MULT12(row_length*rows*model_levels)
      real :: USER_MULT13(row_length*rows*model_levels)
      real :: USER_MULT14(row_length*rows*model_levels)
      real :: USER_MULT15(row_length*rows*model_levels)
      real :: USER_MULT16(row_length*rows*model_levels)
      real :: USER_MULT17(row_length*rows*model_levels)
      real :: USER_MULT18(row_length*rows*model_levels)
      real :: USER_MULT19(row_length*rows*model_levels)
      real :: USER_MULT20(row_length*rows*model_levels)

!     CABLE
      real :: TSOIL_TILE(land_field,ntiles,st_levels)
      real :: SMCL_TILE(land_field,ntiles,sm_levels)
! Not used MRD
!      real :: STHU_TILE(land_field,ntiles,sm_levels)
      real :: STHF_TILE(land_field,ntiles,sm_levels)
      real :: SNOW_DEPTH3L(land_field,ntiles,3)
      real :: SNOW_MASS3L(land_field,ntiles,3)
      real :: SNOW_TMP3L(land_field,ntiles,3)
      real :: SNOW_RHO3L(land_field,ntiles,3)
      real :: SNOW_RHO1L(land_field,ntiles)
      real :: SNOW_AGE(land_field,ntiles)
      real :: SNOW_FLG3L(land_field,ntiles)

! Lestevens Sept 2012 - For CASA-CNP
      real :: CPOOL_TILE(land_field,ntiles,10)
      real :: NPOOL_TILE(land_field,ntiles,10)
      real :: PPOOL_TILE(land_field,ntiles,12)
      real :: SOIL_ORDER(land_field)
      real :: NIDEP(land_field)
      real :: NIFIX(land_field)
      real :: PWEA(land_field)
      real :: PDUST(land_field)
      real :: GLAI(land_field,ntiles)
      real :: PHENPHASE(land_field,ntiles)

      real :: cable_lai(land_field,ntiles)
      
      ! 1.9: Fields carried forward from previous version.
      ! Lateral Boundary Conditions
      real :: OROG_LBC(LENRIMA(fld_type_p,halo_type_extended,1))
      real :: U_LBC(LENRIMA(fld_type_u,halo_type_extended,1),model_levels)
      real :: V_LBC(LENRIMA(fld_type_v,halo_type_extended,1),model_levels)
      real :: W_LBC(LENRIMA(fld_type_p,halo_type_extended,1),0:model_levels)
      real :: RHO_LBC(LENRIMA(fld_type_p,halo_type_extended,1),model_levels)
      real :: THETA_LBC(LENRIMA(fld_type_p,halo_type_extended,1),model_levels)
      real :: Q_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QCL_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QCF_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QCF2_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QRAIN_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QGRAUP_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: CF_BULK_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: CF_LIQUID_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: CF_FROZEN_LBC(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: EXNER_LBC(LENRIMA(fld_type_p,halo_type_extended,1),model_levels+1)
      real :: U_ADV_LBC(LENRIMA(fld_type_u,halo_type_extended,1),model_levels)
      real :: V_ADV_LBC(LENRIMA(fld_type_v,halo_type_extended,1),model_levels)
      real :: W_ADV_LBC(LENRIMA(fld_type_p,halo_type_extended,1),0:model_levels)
      real :: MURK_LBC(LENRIMA(fld_type_p,halo_type_single,1),model_levels)
      
      ! Lateral Boundary Condition tendencies
      real :: U_LBC_TEND(LENRIMA(fld_type_u,halo_type_extended,1),model_levels)
      real :: V_LBC_TEND(LENRIMA(fld_type_v,halo_type_extended,1),model_levels)
      real :: W_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),0:model_levels)
      real :: RHO_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),model_levels)
      real :: THETA_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),model_levels)
      real :: Q_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QCL_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QCF_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QCF2_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QRAIN_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: QGRAUP_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: CF_BULK_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: CF_LIQUID_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: CF_FROZEN_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),wet_levels)
      real :: EXNER_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),model_levels+1)
      real :: U_ADV_LBC_TEND(LENRIMA(fld_type_u,halo_type_extended,1),model_levels)
      real :: V_ADV_LBC_TEND(LENRIMA(fld_type_v,halo_type_extended,1),model_levels)
      real :: W_ADV_LBC_TEND(LENRIMA(fld_type_p,halo_type_extended,1),0:model_levels)
      real :: MURK_LBC_TEND(LENRIMA(fld_type_p,halo_type_single,1),model_levels)

      ! 2: Scalar Variables

      ! 2.1: Data variables stored in primary space.
      real :: TSTAR(row_length,rows)
      real :: LAND(row_length,rows)
      real :: TSTAR_ANOM(row_length,rows)
      ! 2.15: Fields for coastal tiling
      real :: FRAC_LAND(land_field)
      real :: TSTAR_LAND(row_length,rows)
      real :: TSTAR_SEA(row_length,rows)
      real :: TSTAR_SICE(row_length,rows)
      ! Set pointers for sea-ice and land albedos
      real :: SICE_ALB(row_length,rows)
      real :: LAND_ALB(row_length,rows)

      ! 2.2: Data variables stored in secondary space.

      real :: PSTAR(row_length,rows)

      ! 2.3: Cloud fields
      real :: LCBASE(row_length,rows)
      real :: CCB(row_length,rows)
      real :: CCT(row_length,rows)
      real :: CCLWP(row_length,rows)

      ! 2.4: Boundary layer fields

      real :: ZH(row_length,rows)

      ! Standard deviation of turbulent fluctuations of layer 1 temperature
      real :: T1_SD(row_length,rows)

      ! Standard deviation of turbulent fluctuations of layer 1 humidity
      real :: Q1_SD(row_length,rows)

      ! Number of model levels in the  turbulently mixed layer
      real :: NTML(row_length,rows)

      ! Top level for turb mixing in any decoupled Sc layer
      real :: NTDSC(row_length,rows)

      ! Bottom level for turb mixing in any decoupled Sc layer
      real :: NBDSC(row_length,rows)

      real :: CUMULUS(row_length,rows)

      ! 2.4: Soil Ancillary fields

      real :: SAT_SOILW_SUCTION(land_field)
      real :: THERM_CAP(land_field)
      real :: THERM_COND(land_field)
      real :: VOL_SMC_CRIT(land_field)
      real :: VOL_SMC_WILT(land_field)
      real :: VOL_SMC_SAT(land_field)
      real :: SAT_SOIL_COND(land_field)
      real :: CLAPP_HORN(land_field)

      ! 2.5: Vegetation Ancillary fields

      real :: Z0(row_length,rows)
      real :: CANOPY_WATER(land_field)
      real :: SURF_CAP(row_length,rows)
      real :: SURF_RESIST(land_field)
      real :: ROOT_DEPTH(land_field)
      real :: INFILT(land_field)
      real :: VEG_FRAC(land_field)
      real :: LAI(land_field)
      real :: CANHT(land_field)
      real :: SFA(land_field)
      real :: MDSA(land_field)
      real :: GS(land_field)

      ! 2.6: Orographic Ancillary fields

      real :: OROGRAPHY(row_length,rows)
      real :: OROG_SD(land_field)
      real :: OROG_SIL(land_field)
      real :: OROG_HO2(land_field)
      real :: OROG_GRAD_X(land_field)
      real :: OROG_GRAD_Y(land_field)
      real :: OROG_GRAD_XX(land_field)
      real :: OROG_GRAD_XY(land_field)
      real :: OROG_GRAD_YY(land_field)

      ! 2.7: Sea/Sea Ice

      real :: U_SEA(row_length,rows)
      real :: V_SEA(row_length,n_rows)
      real :: U_0_P(row_length,rows)
      real :: V_0_P(row_length,rows)

! these fields are targets b/c there are pointers w/in ATM_STEP
! which point to one or another of them depending on the ice category selection
      real, target :: TI(row_length,rows,1)
      real, target :: ICE_FRACTION(row_length,rows,1)
      real, target :: ICE_THICKNESS(row_length,rows,1)
      real, target :: TI_CAT(row_length,rows,nice) 
      real, target :: ICE_FRACT_CAT(row_length,rows,nice)
      real, target :: ICE_THICK_CAT(row_length,rows,nice)

      ! 2.8: Snow

      real :: SNODEP(row_length,rows)
      real :: SNODEP_SEA(row_length,rows)
      real :: SNODEP_SEA_CAT(row_length,rows,nice)
      real :: CATCH_SNOW(land_field)
      real :: SNOW_GRND(land_field)
      ! SNSOOT may not be used as of vn6.6
      real :: SNSOOT(row_length,rows)  ! Snow soot content

      ! 2.9: aerosol emission fields, including mineral dust parent soil props

      real :: SOIL_CLAY(row_length,rows)
      real :: SOIL_SILT(row_length,rows)
      real :: SOIL_SAND(row_length,rows)
      real :: DUST_MREL1(row_length,rows)
      real :: DUST_MREL2(row_length,rows)
      real :: DUST_MREL3(row_length,rows)
      real :: DUST_MREL4(row_length,rows)
      real :: DUST_MREL5(row_length,rows)
      real :: DUST_MREL6(row_length,rows)

      real :: SO2_EM(row_length,rows)
      real :: DMS_EM(row_length,rows)
      real :: SO2_HILEM(row_length,rows)
      real :: NH3_EM(row_length,rows)
      real :: SOOT_EM(row_length,rows)
      real :: SOOT_HILEM(row_length,rows)
      real :: BMASS_EM(row_length,rows)
      real :: BMASS_HILEM(row_length,rows)
      real :: OCFF_EM(row_length,rows)
      real :: OCFF_HILEM(row_length,rows)
      real :: DMS_CONC(row_length,rows)
      real :: DMS_OFLUX(row_length,rows)

! USER_ANC<N> fields are still 1D; change for 7.1
      ! 2.10: User ancillary fields
      real :: USER_ANC1(row_length*rows*1)
      real :: USER_ANC2(row_length*rows*1)
      real :: USER_ANC3(row_length*rows*1)
      real :: USER_ANC4(row_length*rows*1)
      real :: USER_ANC5(row_length*rows*1)
      real :: USER_ANC6(row_length*rows*1)
      real :: USER_ANC7(row_length*rows*1)
      real :: USER_ANC8(row_length*rows*1)
      real :: USER_ANC9(row_length*rows*1)
      real :: USER_ANC10(row_length*rows*1)
      real :: USER_ANC11(row_length*rows*1)
      real :: USER_ANC12(row_length*rows*1)
      real :: USER_ANC13(row_length*rows*1)
      real :: USER_ANC14(row_length*rows*1)
      real :: USER_ANC15(row_length*rows*1)
      real :: USER_ANC16(row_length*rows*1)
      real :: USER_ANC17(row_length*rows*1)
      real :: USER_ANC18(row_length*rows*1)
      real :: USER_ANC19(row_length*rows*1)
      real :: USER_ANC20(row_length*rows*1)

      ! Tracer fluxes - kdcorbin, 05/10
      real :: TRACER_FLUX1(row_length,rows)
      real :: TRACER_FLUX2(row_length,rows)
      real :: TRACER_FLUX3(row_length,rows)
      real :: TRACER_FLUX4(row_length,rows)
      real :: TRACER_FLUX5(row_length,rows)
      real :: TRACER_FLUX6(row_length,rows)
      real :: TRACER_FLUX7(row_length,rows)
      real :: TRACER_FLUX8(row_length,rows)
      real :: TRACER_FLUX9(row_length,rows)
      real :: TRACER_FLUX10(row_length,rows)
      real :: TRACER_FLUX11(row_length,rows)
      real :: TRACER_FLUX12(row_length,rows)
      real :: TRACER_FLUX13(row_length,rows)
      real :: TRACER_FLUX14(row_length,rows)
      real :: TRACER_FLUX15(row_length,rows)
      real :: TRACER_FLUX16(row_length,rows)
      real :: TRACER_FLUX17(row_length,rows)
      real :: TRACER_FLUX18(row_length,rows)
      real :: TRACER_FLUX19(row_length,rows)
      real :: TRACER_FLUX20(row_length,rows)

      !   2.11: Store arrays for energy correction calculation
      real :: NET_FLUX(row_length,rows)
      real :: NET_MFLUX(row_length,rows)

      !   2.12: Tiled Vegetation and Triffid fields
      real :: FRAC_TYP(land_field)
      real :: FRAC_CON1(land_field)  ! fraction of broadleaf tree
      real :: FRAC_CON2(land_field)  ! fraction of needleleaf tree
      real :: FRAC_CON3(land_field)  ! fraction of C3 grass
      real :: FRAC_CON4(land_field)  ! fraction of C4 grass
      real :: FRAC_CON5(land_field)  ! fraction of shrub
      real :: FRAC_CON6(land_field)  ! fraction of urban
      real :: FRAC_CON7(land_field)  ! fraction of water
      real :: FRAC_CON8(land_field)  ! fraction of soil
      real :: FRAC_CON9(land_field)  ! fraction of ice
      real :: LAI_PFT(land_field)
      real :: CANHT_PFT(land_field)
      real :: DISTURB_VEG(land_field)
      real :: SOIL_ALB(land_field)
      real, target :: SOIL_CARB(land_field)
      real, target :: SOIL_CARB1(land_field)
      real, target :: SOIL_CARB2(land_field)
      real, target :: SOIL_CARB3(land_field)
      real, target :: SOIL_CARB4(land_field)
      real :: NPP_PFT_ACC(land_field)
      real :: G_LF_PFT_ACC(land_field)
      real :: G_PHLF_PFT_ACC(land_field)
      real :: RSP_W_PFT_ACC(land_field)
      real, target :: RSP_S_ACC(land_field)
      real, target :: RSP_S_ACC1(land_field)
      real, target :: RSP_S_ACC2(land_field)
      real, target :: RSP_S_ACC3(land_field)
      real, target :: RSP_S_ACC4(land_field)
      real :: CAN_WATER_TILE(land_field)
      real :: CATCH_TILE(land_field)
      real :: INFIL_TILE(land_field)
      real :: RGRAIN_TILE(land_field)
      real :: SNODEP_TILE(land_field)
      real :: TSTAR_TILE(land_field) 
      real :: Z0_TILE(land_field)  
      real :: DOLR_FIELD(row_length,rows) 
      real :: LW_DOWN(row_length,rows) 
      real :: SW_TILE_RTS(land_field)

!! REMOVING SLAB AS PART OF VN7.0
!      !   2.13: Slab Model
!      real :: TSLAB(row_length*rows*1)
!      real :: TCLIM(row_length*rows*1)
!      real :: HCLIM(row_length*rows*1)
!      real :: CHEAT(row_length*rows*1)
!      real :: OIFLX(row_length*rows*1)
!      real :: UICE(row_length*rows*1)
!      real :: VICE(row_length*n_rows*1)
!      real :: SIG11NE(row_length*rows*1)
!      real :: SIG11SE(row_length*rows*1) 
!      real :: SIG11SW(row_length*rows*1)
!      real :: SIG11NW(row_length*rows*1)
!      real :: SIG12NE(row_length*rows*1)
!      real :: SIG12SE(row_length*rows*1)
!      real :: SIG12NW(row_length*rows*1)
!      real :: SIG22NE(row_length*rows*1)
!      real :: SIG22SE(row_length*rows*1)
!      real :: SIG22SW(row_length*rows*1)
!      real :: SIG22NW(row_length*rows*1)

!   2.14: Carbon cycle fields
      real :: CO2FLUX(row_length,rows)
      real :: CO2_EMITS(row_length,rows)

!   2.15: Fields carried forward from previous version.
!         May not be required
!      real, pointer :: SURF_RESIST_NIT(:)  ! Surface resistance on
!                                    ! non-ice tiles
!      real, pointer :: ROOT_DEPTH_NIT(:)   ! Root depth on non-ice tiles
!      real, pointer :: Z0V_TYP(:)          ! Vegetative Roughness length on
!                                    ! tiles
!      real, pointer :: ICE_EDGE(:)
!      real, pointer :: OROG_TENDENCY(:)    ! Orographic tendencies
!      real, pointer :: OROG_SD_TENDENCY(:) ! Orographic variable tendency

      ! Pointers for ATMOSPHERE model constants. Scalars only.
      ! Addresses in level dependent constants array.
!      real, pointer :: ETATHETA(:)
!      real, pointer :: ETARHO(:)
!      real, pointer :: RHCRIT(:)
!      real, pointer :: SOIL_THICKNESS(:)
! these fields are still 1D; change for 7.1
      ! Definition of height(i,j,k) = zsea(k) + C(k)*zorog(i,j)
      real :: zseak_theta(0:model_levels)
      real :: Ck_theta(0:model_levels)
      real :: zseak_rho(model_levels)
      real :: Ck_rho(model_levels)   

      ! 2.16: Fields for large-scale hydrology scheme.
      real :: TI_MEAN(land_field)
      real :: TI_SIG(land_field)
      real :: FEXP(land_field)
      real :: GAMMA_INT(land_field)
      real :: WATER_TABLE(land_field)
      real :: FSFC_SAT(land_field)
      real :: F_WETLAND(land_field)

      real :: STHZW(land_field)
      real :: A_FSAT(land_field)
      real :: C_FSAT(land_field)
      real :: A_FWET(land_field)
      real :: C_FWET(land_field)

      ! 2.17: Fields for River routing.
      real :: RIV_SEQUENCE(river_row_length,river_rows)
      real :: RIV_DIRECTION(river_row_length,river_rows)
      real :: RIV_STORAGE(river_row_length,river_rows)
      real :: TOT_SURFROFF(river_row_length,river_rows)
      real :: TOT_SUBROFF(river_row_length,river_rows)
      real :: RIV_INLANDATM(land_field)
      ! Fields for grid-to-grid river routing (river routing 2A)
      real :: RIV_IAREA(row_length,rows)      ! Drainage area
      real :: RIV_SLOPE(row_length,rows)      ! Grid-cell slope
      real :: RIV_FLOWOBS1(row_length,rows)   ! Initial values of flow
      real :: RIV_INEXT(row_length,rows)      ! Flow direction (x)
      real :: RIV_JNEXT(row_length,rows)      ! Flow direction (y)
      real :: RIV_LAND(row_length,rows)       ! Land-type (land/river/sea)
      real :: RIV_SUBSTORE(row_length,rows)   ! Subsurface storage
      real :: RIV_SURFSTORE(row_length,rows)  ! Surface storage
      real :: RIV_FLOWIN(row_length,rows)     ! Surface inflow
      real :: RIV_BFLOWIN(row_length,rows)    ! Subsurface inflow

! Fields used when coupling using OASIS.
      real :: C_SOLAR(row_length,rows)         ! CPL solar radn
      real :: C_BLUE(row_length,rows)          ! CPL blue radn
      real :: C_DOWN(row_length,rows)          ! CPL downward radn
      real :: C_LONGWAVE(row_length,rows)      ! CPL lw radn
      real :: C_TAUX(row_length,rows)          ! CPL taux 
      real :: C_TAUY(row_length,rows)          ! CPL tauy 
      real :: C_WINDMIX(row_length,rows)       ! CPL WME   
      real :: C_SENSIBLE(row_length,rows)      ! CPL sensible ht flx
      real :: C_SUBLIM(row_length,rows)        ! CPL sublim rate
      real :: C_EVAP(row_length,rows)          ! CPL Evap rate
      real :: C_BOTMELTN(row_length,rows,nice) ! CPL Multi-cat bmlt
      real :: C_TOPMELTN(row_length,rows,nice) ! CPL Multi-cat tmlt
      real :: C_LSRAIN(row_length,rows)        ! CPL Lg scl rain rate
      real :: C_LSSNOW(row_length,rows)        ! CPL Lg scl snow rate
      real :: C_CVRAIN(row_length,rows)        ! CPL Cnvctv rain rate
      real :: C_CVSNOW(row_length,rows)        ! CPL Cnvctv snur rate
      real :: C_RIVEROUT(row_length,rows)      ! CPL Riv outflow->ocn                     

      real :: C_PRESS(row_length,rows)         ! CPL Surf pressure->ocn                     
      real :: C_U10(row_length,rows)         ! CPL 10m wind speed
      real :: C_V10(row_length,rows)         ! CPL 10m wind speed


! UKCA fields are still 1D; change for 7.1
      ! UKCA oxidant fields
      real :: OH_UKCA(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: HO2_UKCA(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: H2O2_UKCA(1-offx:row_length+offx,1-offy:rows+offy,model_levels)
      real :: O3_UKCA(1-offx:row_length+offx,1-offy:rows+offy,model_levels)

      ! Aerosol climatologies
      real :: ARCLBIOG_BG(row_length,rows,model_levels)
      real :: ARCLBIOM_FR(row_length,rows,model_levels)
      real :: ARCLBIOM_AG(row_length,rows,model_levels)
      real :: ARCLBIOM_IC(row_length,rows,model_levels)
      real :: ARCLBLCK_FR(row_length,rows,model_levels)
      real :: ARCLBLCK_AG(row_length,rows,model_levels)
      real :: ARCLSSLT_FI(row_length,rows,model_levels)
      real :: ARCLSSLT_JT(row_length,rows,model_levels)
      real :: ARCLSULP_AC(row_length,rows,model_levels)
      real :: ARCLSULP_AK(row_length,rows,model_levels)
      real :: ARCLSULP_DI(row_length,rows,model_levels)
      real :: ARCLDUST_B1(row_length,rows,model_levels)
      real :: ARCLDUST_B2(row_length,rows,model_levels)
      real :: ARCLDUST_B3(row_length,rows,model_levels)
      real :: ARCLDUST_B4(row_length,rows,model_levels)
      real :: ARCLDUST_B5(row_length,rows,model_levels)
      real :: ARCLDUST_B6(row_length,rows,model_levels)
      real :: ARCLOCFF_FR(row_length,rows,model_levels)
      real :: ARCLOCFF_AG(row_length,rows,model_levels)
      real :: ARCLOCFF_IC(row_length,rows,model_levels)
      real :: ARCLDLTA_DL(row_length,rows,model_levels)

! End typ_atm_fields.h
